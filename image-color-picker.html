<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Image Color Picker | MultiTools</title>
  <meta name="description" content="Pick colors from any uploaded image and get HEX, RGB values. Free online image color picker. Multietools.">
  <meta property="og:title" content="Image Color Picker | MultiTools">
  <meta property="og:description" content="Pick colors from any uploaded image and get HEX, RGB values. Free online image color picker. Multietools.">
  <meta property="og:type" content="website">
    <meta property="og:image" content="https://ranjit-15.github.io/multietools/htdocs/og-image.svg">
  <link rel="canonical" href="https://ranjit-15.github.io/multietools/htdocs/image-color-picker.html">
  <link rel="stylesheet" href="css/global.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    .wrap { max-width: 1100px; margin: 0 auto; padding: 2rem 1rem 3rem; }
    .back-link { display: inline-flex; align-items: center; gap: .4rem; color: var(--primary); text-decoration: none; font-size: .95rem; margin-bottom: .8rem; transition: opacity .2s; }
    .back-link:hover { opacity: .75; }
    header h1 { font-size: 1.75rem; display: flex; align-items: center; gap: .6rem; color: var(--text); margin: 0 0 .3rem; }
    header h1 i { color: var(--primary); }
    .muted { color: var(--muted); font-size: .95rem; margin-bottom: 1.5rem; }

    /* Panels */
    .panel { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: var(--shadow-xs); }
    .panel-title { font-size: 1.1rem; font-weight: 600; color: var(--text); margin: 0 0 1rem; display: flex; align-items: center; gap: .5rem; }
    .panel-title i { color: var(--primary); font-size: .95rem; }

    /* Drop zone */
    .drop-zone { border: 2px dashed var(--border-light); border-radius: var(--radius-md); padding: 2.5rem 1.5rem; text-align: center; cursor: pointer; transition: border-color .25s, background .25s; background: var(--bg-alt); }
    .drop-zone.dragover { border-color: var(--primary); background: color-mix(in srgb, var(--primary) 8%, var(--bg-alt)); }
    .drop-zone i.upload-icon { font-size: 2.4rem; color: var(--primary); margin-bottom: .6rem; }
    .drop-zone p { margin: .3rem 0; color: var(--muted); font-size: .92rem; }
    .drop-zone .browse-btn { display: inline-block; margin-top: .7rem; padding: .5rem 1.2rem; background: var(--primary); color: #fff; border-radius: var(--radius-sm); font-size: .9rem; font-weight: 500; cursor: pointer; transition: box-shadow .2s; }
    .drop-zone .browse-btn:hover { box-shadow: 0 0 12px var(--primary-glow); }
    .drop-zone input[type="file"] { display: none; }

    /* Canvas area */
    .canvas-wrapper { position: relative; overflow: hidden; border-radius: var(--radius-md); border: 1px solid var(--border); background: var(--bg-alt); min-height: 200px; display: flex; align-items: center; justify-content: center; cursor: crosshair; }
    .canvas-wrapper canvas { display: block; max-width: 100%; height: auto; }
    .canvas-placeholder { color: var(--muted); font-size: .95rem; text-align: center; padding: 2rem; }
    .canvas-placeholder i { font-size: 2rem; display: block; margin-bottom: .5rem; color: var(--border-light); }

    /* Magnifier */
    .magnifier { position: absolute; width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--primary); box-shadow: 0 0 0 2px var(--surface), var(--shadow-md); pointer-events: none; display: none; background-repeat: no-repeat; z-index: 10; image-rendering: pixelated; }
    .magnifier::after { content: '+'; position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; font-weight: 700; color: var(--primary); opacity: .6; }

    /* Layout row */
    .result-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
    @media (max-width: 720px) { .result-row { grid-template-columns: 1fr; } }

    /* Color swatch preview */
    .swatch-preview { width: 100%; aspect-ratio: 1.6; border-radius: var(--radius-md); border: 1px solid var(--border); background: var(--bg-alt); transition: background .2s; display: flex; align-items: center; justify-content: center; }
    .swatch-preview span { color: var(--muted); font-size: .9rem; }

    /* Color values */
    .color-values { display: flex; flex-direction: column; gap: .75rem; justify-content: center; }
    .color-row { display: flex; align-items: center; gap: .5rem; }
    .color-row label { min-width: 42px; font-weight: 600; font-size: .85rem; color: var(--muted); text-transform: uppercase; }
    .color-row input[type="text"] { flex: 1; background: var(--bg-alt); border: 1px solid var(--border); border-radius: var(--radius-sm); padding: .5rem .65rem; font-family: 'Fira Mono', 'Consolas', monospace; font-size: .92rem; color: var(--text); outline: none; transition: border-color .2s; }
    .color-row input[type="text"]:focus { border-color: var(--primary); }
    .copy-btn { background: var(--primary); color: #fff; border: none; border-radius: var(--radius-sm); padding: .45rem .7rem; cursor: pointer; font-size: .82rem; display: flex; align-items: center; gap: .3rem; transition: box-shadow .2s, opacity .2s; white-space: nowrap; }
    .copy-btn:hover { box-shadow: 0 0 10px var(--primary-glow); }
    .copy-btn.copied { background: var(--success); }

    /* History palette */
    .palette-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: .75rem; }
    .clear-btn { background: none; border: 1px solid var(--border); color: var(--muted); border-radius: var(--radius-sm); padding: .35rem .8rem; font-size: .82rem; cursor: pointer; transition: color .2s, border-color .2s; }
    .clear-btn:hover { color: var(--error); border-color: var(--error); }
    .palette-grid { display: flex; flex-wrap: wrap; gap: .5rem; min-height: 38px; }
    .palette-swatch { width: 38px; height: 38px; border-radius: var(--radius-sm); border: 2px solid var(--border); cursor: pointer; transition: transform .15s, box-shadow .15s; }
    .palette-swatch:hover { transform: scale(1.15); box-shadow: var(--shadow-md); }
    .palette-empty { color: var(--muted); font-size: .88rem; padding: .35rem 0; }

    /* Toast */
    #toast-container { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 9999; display: flex; flex-direction: column; gap: .5rem; }
    .toast { padding: .65rem 1.1rem; border-radius: var(--radius-sm); color: #fff; font-size: .9rem; font-weight: 500; box-shadow: var(--shadow-lg); animation: toastIn .3s ease, toastOut .35s ease 2.4s forwards; display: flex; align-items: center; gap: .5rem; }
    .toast.success { background: var(--success); }
    .toast.error { background: var(--error); }
    .toast.info { background: var(--primary); }
    @keyframes toastIn { from { opacity: 0; transform: translateY(12px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes toastOut { from { opacity: 1; } to { opacity: 0; transform: translateY(-8px); } }

    /* Responsive tweaks */
    @media (max-width: 520px) {
      .wrap { padding: 1.2rem .6rem 2rem; }
      header h1 { font-size: 1.35rem; }
      .panel { padding: 1rem; }
      .magnifier { width: 90px; height: 90px; }
    }
  </style>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
</head>
<body>
  <div class="wrap">
    <header>
      <a href="tools.html" class="back-link"><i class="fa-solid fa-arrow-left"></i> Back to Tools</a>
      <h1><i class="fa-solid fa-eye-dropper"></i> Image Color Picker</h1>
      <p class="muted">Upload an image and click anywhere to pick colors. View in HEX, RGB &amp; HSL, save to a palette, and copy with one click.</p>
    </header>

    <main>
      <!-- Upload -->
      <div class="panel" id="uploadPanel">
        <div class="drop-zone" id="dropZone">
          <i class="fa-solid fa-cloud-arrow-up upload-icon"></i>
          <p><strong>Drag &amp; drop</strong> an image here</p>
          <p>or</p>
          <span class="browse-btn" id="browseBtn">Browse File</span>
          <input type="file" id="fileInput" accept="image/*" />
        </div>
      </div>

      <!-- Canvas + Magnifier -->
      <div class="panel" id="canvasPanel" style="display:none;">
        <h3 class="panel-title"><i class="fa-solid fa-image"></i> Image Preview <small style="font-weight:400;color:var(--muted);margin-left:auto;font-size:.82rem;">Click to pick color</small></h3>
        <div class="canvas-wrapper" id="canvasWrapper">
          <canvas id="imgCanvas"></canvas>
          <div class="magnifier" id="magnifier"></div>
        </div>
      </div>

      <!-- Results -->
      <div class="panel" id="resultPanel" style="display:none;">
        <h3 class="panel-title"><i class="fa-solid fa-palette"></i> Picked Color</h3>
        <div class="result-row">
          <div class="swatch-preview" id="swatchPreview"><span>No color picked yet</span></div>
          <div class="color-values">
            <div class="color-row">
              <label>HEX</label>
              <input type="text" id="hexVal" readonly />
              <button class="copy-btn" data-target="hexVal"><i class="fa-regular fa-copy"></i> Copy</button>
            </div>
            <div class="color-row">
              <label>RGB</label>
              <input type="text" id="rgbVal" readonly />
              <button class="copy-btn" data-target="rgbVal"><i class="fa-regular fa-copy"></i> Copy</button>
            </div>
            <div class="color-row">
              <label>HSL</label>
              <input type="text" id="hslVal" readonly />
              <button class="copy-btn" data-target="hslVal"><i class="fa-regular fa-copy"></i> Copy</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Palette history -->
      <div class="panel" id="palettePanel" style="display:none;">
        <div class="palette-header">
          <h3 class="panel-title" style="margin:0;"><i class="fa-solid fa-swatchbook"></i> Color Palette</h3>
          <button class="clear-btn" id="clearPalette"><i class="fa-solid fa-trash-can"></i> Clear</button>
        </div>
        <div class="palette-grid" id="paletteGrid">
          <span class="palette-empty">Pick colors to build your paletteâ€¦</span>
        </div>
      </div>
    </main>
  </div>

  <div id="toast-container"></div>

  <script src="js/global.js"></script>
  <script>
  (() => {
    /* â”€â”€ Helpers â”€â”€ */
    function rgbToHsl(r, g, b) {
      r /= 255; g /= 255; b /= 255;
      const max = Math.max(r, g, b), min = Math.min(r, g, b), d = max - min;
      let h = 0, s = 0, l = (max + min) / 2;
      if (d) {
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
          case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
          case g: h = ((b - r) / d + 2) / 6; break;
          case b: h = ((r - g) / d + 4) / 6; break;
        }
      }
      return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];
    }

    function componentToHex(c) { const h = c.toString(16); return h.length === 1 ? '0' + h : h; }
    function rgbToHex(r, g, b) { return '#' + componentToHex(r) + componentToHex(g) + componentToHex(b); }

    function toast(msg, type = 'info') {
      const el = document.createElement('div');
      el.className = 'toast ' + type;
      el.innerHTML = '<i class="fa-solid ' + (type === 'success' ? 'fa-check' : type === 'error' ? 'fa-xmark' : 'fa-circle-info') + '"></i> ' + msg;
      document.getElementById('toast-container').appendChild(el);
      setTimeout(() => el.remove(), 2800);
    }

    /* â”€â”€ DOM refs â”€â”€ */
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('fileInput');
    const browseBtn = document.getElementById('browseBtn');
    const canvas = document.getElementById('imgCanvas');
    const ctx = canvas.getContext('2d', { willReadFrequently: true });
    const canvasWrapper = document.getElementById('canvasWrapper');
    const magnifier = document.getElementById('magnifier');
    const uploadPanel = document.getElementById('uploadPanel');
    const canvasPanel = document.getElementById('canvasPanel');
    const resultPanel = document.getElementById('resultPanel');
    const palettePanel = document.getElementById('palettePanel');
    const swatchPreview = document.getElementById('swatchPreview');
    const hexVal = document.getElementById('hexVal');
    const rgbVal = document.getElementById('rgbVal');
    const hslVal = document.getElementById('hslVal');
    const paletteGrid = document.getElementById('paletteGrid');

    const ZOOM = 6;
    const MAG_SIZE = 120;
    const MAX_PALETTE = 20;
    let palette = [];
    let imgLoaded = false;

    /* â”€â”€ Drop zone events â”€â”€ */
    browseBtn.addEventListener('click', () => fileInput.click());
    dropZone.addEventListener('click', (e) => { if (e.target !== browseBtn && !browseBtn.contains(e.target)) fileInput.click(); });

    ['dragenter', 'dragover'].forEach(ev => dropZone.addEventListener(ev, e => { e.preventDefault(); dropZone.classList.add('dragover'); }));
    ['dragleave', 'drop'].forEach(ev => dropZone.addEventListener(ev, e => { e.preventDefault(); dropZone.classList.remove('dragover'); }));

    dropZone.addEventListener('drop', e => {
      const file = e.dataTransfer.files[0];
      if (file) handleFile(file);
    });
    fileInput.addEventListener('change', () => { if (fileInput.files[0]) handleFile(fileInput.files[0]); });

    /* â”€â”€ Load image â”€â”€ */
    function handleFile(file) {
      if (!file.type.startsWith('image/')) { toast('Please select a valid image file.', 'error'); return; }
      const reader = new FileReader();
      reader.onload = e => {
        const img = new Image();
        img.onload = () => {
          /* Scale canvas for display, keeping aspect ratio */
          const maxW = canvasWrapper.clientWidth - 2;
          let w = img.naturalWidth, h = img.naturalHeight;
          if (w > maxW) { h = Math.round(h * maxW / w); w = maxW; }
          canvas.width = w;
          canvas.height = h;
          ctx.drawImage(img, 0, 0, w, h);
          imgLoaded = true;
          canvasPanel.style.display = '';
          resultPanel.style.display = '';
          palettePanel.style.display = '';
          toast('Image loaded â€” click to pick colors!', 'success');
        };
        img.src = e.target.result;
      };
      reader.readAsDataURL(file);
    }

    /* â”€â”€ Magnifier â”€â”€ */
    canvasWrapper.addEventListener('mousemove', e => {
      if (!imgLoaded) return;
      magnifier.style.display = 'block';
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const half = MAG_SIZE / 2;

      /* position magnifier */
      magnifier.style.left = (x - half) + 'px';
      magnifier.style.top = (y - half) + 'px';

      /* background = zoomed canvas region */
      const bgW = canvas.width * ZOOM;
      const bgH = canvas.height * ZOOM;
      const bgX = -(x * ZOOM - half);
      const bgY = -(y * ZOOM - half);
      magnifier.style.backgroundImage = 'url(' + canvas.toDataURL() + ')';
      magnifier.style.backgroundSize = bgW + 'px ' + bgH + 'px';
      magnifier.style.backgroundPosition = bgX + 'px ' + bgY + 'px';
    });
    canvasWrapper.addEventListener('mouseleave', () => { magnifier.style.display = 'none'; });

    /* â”€â”€ Pick color on click â”€â”€ */
    canvas.addEventListener('click', e => {
      if (!imgLoaded) return;
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      const px = Math.floor((e.clientX - rect.left) * scaleX);
      const py = Math.floor((e.clientY - rect.top) * scaleY);
      const [r, g, b] = ctx.getImageData(px, py, 1, 1).data;
      applyColor(r, g, b);
      addToPalette(rgbToHex(r, g, b));
    });

    /* â”€â”€ Apply picked color â”€â”€ */
    function applyColor(r, g, b) {
      const hex = rgbToHex(r, g, b);
      const [h, s, l] = rgbToHsl(r, g, b);
      swatchPreview.style.background = hex;
      swatchPreview.innerHTML = '';
      hexVal.value = hex.toUpperCase();
      rgbVal.value = `rgb(${r}, ${g}, ${b})`;
      hslVal.value = `hsl(${h}, ${s}%, ${l}%)`;
    }

    /* â”€â”€ Copy buttons â”€â”€ */
    document.querySelectorAll('.copy-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const input = document.getElementById(btn.dataset.target);
        if (!input.value) return;
        navigator.clipboard.writeText(input.value).then(() => {
          btn.classList.add('copied');
          const orig = btn.innerHTML;
          btn.innerHTML = '<i class="fa-solid fa-check"></i> Copied';
          toast('Copied ' + input.value, 'success');
          setTimeout(() => { btn.classList.remove('copied'); btn.innerHTML = orig; }, 1500);
        }).catch(() => toast('Copy failed', 'error'));
      });
    });

    /* â”€â”€ Palette â”€â”€ */
    function addToPalette(hex) {
      hex = hex.toUpperCase();
      /* remove duplicate if already in palette */
      palette = palette.filter(c => c !== hex);
      palette.unshift(hex);
      if (palette.length > MAX_PALETTE) palette.pop();
      renderPalette();
    }

    function renderPalette() {
      if (!palette.length) {
        paletteGrid.innerHTML = '<span class="palette-empty">Pick colors to build your paletteâ€¦</span>';
        return;
      }
      paletteGrid.innerHTML = '';
      palette.forEach(hex => {
        const sw = document.createElement('div');
        sw.className = 'palette-swatch';
        sw.style.background = hex;
        sw.title = hex;
        sw.addEventListener('click', () => {
          const r = parseInt(hex.slice(1, 3), 16);
          const g = parseInt(hex.slice(3, 5), 16);
          const b = parseInt(hex.slice(5, 7), 16);
          applyColor(r, g, b);
          toast('Selected ' + hex, 'info');
        });
        paletteGrid.appendChild(sw);
      });
    }

    document.getElementById('clearPalette').addEventListener('click', () => {
      palette = [];
      renderPalette();
      toast('Palette cleared', 'info');
    });

    /* â”€â”€ Optimise magnifier: cache data URL on mouseenter â”€â”€ */
    let cachedDataURL = '';
    canvasWrapper.addEventListener('mouseenter', () => {
      if (imgLoaded) cachedDataURL = canvas.toDataURL();
    });
    /* Override the mousemove to use cached URL for better performance */
    canvasWrapper.addEventListener('mousemove', function handler(e) {
      if (!imgLoaded || !cachedDataURL) return;
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      const half = MAG_SIZE / 2;
      magnifier.style.left = (x - half) + 'px';
      magnifier.style.top = (y - half) + 'px';
      const bgW = canvas.width * ZOOM;
      const bgH = canvas.height * ZOOM;
      magnifier.style.backgroundImage = 'url(' + cachedDataURL + ')';
      magnifier.style.backgroundSize = bgW + 'px ' + bgH + 'px';
      magnifier.style.backgroundPosition = -(x * ZOOM - half) + 'px ' + -(y * ZOOM - half) + 'px';
    }, true);   /* capture phase overrides the first handler */

  })();
  </script>
</body>
</html>
